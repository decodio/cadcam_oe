<?xml version="1.0" encoding="utf-8"?>

<openerp>
	<data>
		<record id="view_order_form_lines_on_line_ccg" model="ir.ui.view">
			<field name="name">view_order_form_lines_on_line_ccg</field>
			<field name="model">sale.order</field>
			<field name="inherit_id" ref="sp_cadcam.view_order_form_lines_on_line" />
			<field name="arch" type="xml">
				<xpath
					expr="//page[@string='Advanced']/group/group/field[@name='partner_bank_id']"
					position="attributes">
					<attribute name="domain">
						[ ('partner_id.ref_companies', 'in',
						[company_id]),
						('footer', '=', True)]
					</attribute>
					<attribute name="required">True</attribute>
				</xpath>
			</field>
		</record>

		<record id="cadcam_view_quotation_tree_ccg" model="ir.ui.view">
			<field name="name">cadcam.view.quotation.tree.ccg</field>
			<field name="model">sale.order</field>
			<field name="inherit_id" ref="sp_cadcam.cadcam_view_quotation_tree" />
			<field name="type">tree</field>
			<field name="arch" type="xml">
				<xpath expr="//tree/field[@name='user_id']" position="attributes">
					<attribute name="string">Salesman</attribute>
				</xpath>
			</field>
		</record>

		<record id="sale_order_inherit_other_data_cadcam_ccg" model="ir.ui.view">
			<field name="name">sale.order.form.inherit.other.data.ccg</field>
			<field name="model">sale.order</field>
			<field name="inherit_id" ref="sp_cadcam.sale_order_inherit_other_data_cadcam" />
			<field name="type">form</field>
			<field name="arch" type="xml">
				<xpath
					expr="//page[@string='Other Data']/group/button[@string='Add Price Data']"
					position="replace">
				</xpath>
				<xpath expr="//page[@string='Other Data']/group/field[@name='price_ids']"
					position="replace">
				</xpath>
				<!-- Hide original payment term field from document -->
				<xpath expr="//group/field[@name='payment_term']" position="attributes">
					<attribute name="invisible">True</attribute>
				</xpath>

				<!-- Hide original payment mode field from document -->
				<xpath expr="//group/field[@name='payment_mode_id']" position="attributes">
					<attribute name="invisible">True</attribute>
				</xpath>

				<!-- Hide original Contract analytic field from document -->
				<xpath expr="//group/field[@name='project_id']" position="attributes">
					<attribute name="invisible">True</attribute>
				</xpath>

				<!-- Hide Export data group -->
				<xpath
					expr="//page[@string='Other Data']/group/group[@string='Export data']"
					position="attributes">
					<attribute name="invisible">True</attribute>
				</xpath>

				<!-- Add payment data field -->
				<xpath
					expr="//page[@string='Other Data']/group/group[@string='Sales data']"
					position="inside">
					<field name="payment_data" />
				</xpath>

				<xpath
					expr="//page[@string='Other Data']/group/button[@string='Add licence period']"
					position="replace">
				</xpath>


				<xpath
					expr="//page[@string='Other Information']/group/group[@name='sales_person']/field[@name='user_id']"
					position="attributes">
					<attribute name="string">Salesman</attribute>
				</xpath>

				<!-- change behavior of line discount fields -->
				<xpath
					expr="//notebook/page[@string='Order Lines']/field[@name='order_line']/form[@string='Sales Order Lines']//field[@name='discount_total' and @groups='sale.group_discount_per_so_line']"
					position="attributes">
					<attribute name="readonly">0</attribute>
					<attribute name="on_change">on_change_line_discount_total(discount_total,
						price_unit, global_discount_percent, quantity)
					</attribute>
				</xpath>

				<!-- change behavior of global discount fields -->
				<xpath
					expr="//group[@name='sale_total']/field[@name='global_discount_percent']"
					position="before">
					<field name="discount_total" readonly="True" widget="monetary"
						options="{'currency_field': 'currency_id'}" />
				</xpath>
				<xpath
					expr="//group[@name='sale_total']/field[@name='global_discount_percent']"
					position="attributes">
					<attribute name="string">Global discount (%): </attribute>
				</xpath>
				<xpath expr="//field[@name='additional_discount_amount']"
					position="attributes">
					<attribute name="readonly"> False</attribute>
					<attribute name="on_change">on_change_additional_discount_amount(additional_discount_amount,
						list_amount,discount_total, global_discount_percent)
					</attribute>
				</xpath>
			</field>
		</record>

		<record id="view_sales_order_filter_ccg" model="ir.ui.view">
			<field name="name">view.sales.order.filter.ccg</field>
			<field name="model">sale.order</field>
			<field name="inherit_id" ref="sale.view_sales_order_filter" />
			<field name="type">form</field>
			<field name="arch" type="xml">
				<!-- English 2 English translation will be better... -->
				<xpath expr="//search/filter[@name='sales']" position="attributes">
					<attribute name="string">Sales Orders</attribute>
				</xpath>
				<xpath expr="//search/filter[1]" position="attributes">
					<attribute name="string">Salesman</attribute>
				</xpath>
			</field>
		</record>

	</data>
</openerp>