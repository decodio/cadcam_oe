<?xml version="1.0"?>
<form string="Sales Order">
                    <header>
                        <button name="invoice_recreate" states="invoice_except" string="Recreate Invoice" groups="base.group_user"/>
                        <button name="invoice_corrected" states="invoice_except" string="Ignore Exception" groups="base.group_user"/>
                        <button name="action_quotation_send" string="Send by Email" type="object" states="draft" class="oe_highlight" groups="base.group_user"/>
                        <button name="action_quotation_send" string="Send by Email" type="object" states="sent,progress,manual" groups="base.group_user"/>
                        <button name="print_quotation" string="Print" type="object" states="draft" class="oe_highlight" groups="base.group_user"/>
                        <button name="print_quotation" string="Print" type="object" states="sent,progress,manual" groups="base.group_user"/>
                        <button name="action_button_confirm" states="draft" string="Confirm Sale" type="object" groups="base.group_user"/>
                        <button name="action_button_confirm" states="sent" string="Confirm Sale" class="oe_highlight" type="object" groups="base.group_user"/>
                        <button name="action_view_invoice" string="View Invoice" type="object" class="oe_highlight" attrs="{'invisible': [('invoice_exists', '=', False)]}" groups="base.group_user"/>
                        <button name="27855" string="Create Invoice" type="action" states="manual" class="oe_highlight" groups="base.group_user"/>
                        <button name="copy_quotation" states="cancel" string="New Copy of Quotation" type="object"/>
                        <button name="cancel" states="draft,sent" string="Cancel Quotation" groups="base.group_user"/>
                        <button name="action_cancel" states="manual,progress" string="Cancel Order" type="object" groups="base.group_user"/>
                        <button name="invoice_cancel" states="invoice_except" string="Cancel Order" groups="base.group_user"/>
                        <field name="state" widget="statusbar" statusbar_visible="draft,sent,progress,done" statusbar_colors="{&quot;invoice_except&quot;:&quot;red&quot;,&quot;waiting_date&quot;:&quot;blue&quot;}"/>
                </header>
                <sheet>
                    <h1>
                        <label string="Quotation " attrs="{'invisible': [('state','not in',('draft','sent'))]}"/>
                        <label string="Sales Order " attrs="{'invisible': [('state','in',('draft','sent'))]}"/>
                        <field name="name" class="oe_inline" readonly="1"/>
                    </h1>
                    <group>
                        <group>
                            <field name="partner_id" domain="['&amp;',('customer', '=', True),('parent_id','=',False)]" context="{'search_default_customer':1, 'show_address': 1}" options="{&quot;always_reload&quot;: True}"/>
                            <field name="partner_invoice_id" groups="sale.group_delivery_invoice_address" context="{'default_type':'invoice'}"/>
                            <field name="partner_shipping_id" groups="sale.group_delivery_invoice_address" context="{'default_type':'delivery'}"/>
                            <field name="project_id" context="{'partner_id':partner_invoice_id, 'manager_id': user_id, 'default_pricelist_id':pricelist_id, 'default_name':name, 'default_type': 'contract'}" groups="sale.group_analytic_accounting" domain="[('type','in',['view','normal','contract'])]"/>
                            <field name="fiscal_position" options="{'no_create': True}"/>
                            <field name="entry_type" groups="account.group_account_user"/>
                        </group>
                        <group>
                            <field name="date_order"/>
                            <field name="payment_term" />
                            <field name="client_order_ref"/>
                            <field name="pricelist_id" domain="[('type','=','sale')]" groups="product.group_sale_pricelist"/>
                            <label for="currency_id" groups="base.group_multi_currency"/>
                            <div groups="base.group_multi_currency">
                                <field name="currency_id" class="oe_inline"/>
                                <button name="860042" type="action" class="oe_inline oe_link oe_edit_only" string="(change)" attrs="{'invisible':[('state','!=','draft')]}"/>
                            </div>
                        </group>
                    </group>
                    <notebook>
                        <page string="Order Lines">
                            <field name="order_line">
                                <form string="Sales Order Lines">
                                    <header groups="base.group_user">
                                        <button name="27859" states="confirmed" string="Invoice" type="action" icon="terp-document-new"/>
                                        <field name="state" widget="statusbar" statusbar_visible="draft,confirmed,done" statusbar_colors="{&quot;exception&quot;:&quot;red&quot;,&quot;cancel&quot;:&quot;red&quot;}"/>
                                    </header>
                                   <label for="product_id" class="oe_edit_only"/>
                                    <h3><field name="product_id"/></h3>
                                    <group name="first_row" col="20">
                                        <group name="first_row_left" colspan="8">
                                            <field name="name" nolabel="1" widget="text"/>
                                        </group>
                                        <group name="first_row_right" colspan="12">
                                                <label for="quantity"/>
                                                <div>
                                                    <field name="quantity" class="oe_inline"/>
                                                    <field name="uom_id" attrs="{'readonly': [('product_id.uom_alternatives','=', False)]}" options="{'no_open':True}" class="oe_inline" groups="product.group_uom"/> = 
                                                    <field name="base_uom_qty" attrs="{'readonly': [('product_id.mes_type','!=','variable')]}" class="oe_inline"/>
                                                    <field name="base_uom_id" readonly="1" options="{'no_open':True}" class="oe_inline"/>
                                                </div>
                                                <field name="price_unit" widget="monetary"/>
                                                <label for="discount1_percent" string="Discounts" groups="sale.group_discount_per_so_line"/>
                                                <div groups="sale.group_discount_per_so_line">
                                                    <field name="global_discount_percent" class="oe_inline" groups="sale.group_discount_per_so_line"/> + 
                                                    <field name="discount1_percent" class="oe_inline" groups="sale.group_discount_per_so_line"/> + 
                                                    <field name="discount2_percent" class="oe_inline" groups="base.group_advance_discount"/> = 
                                                    <field name="discount" readonly="1" class="oe_inline" groups="sale.group_discount_per_so_line"/> %
                                                    
                                                </div>
                                                <label for="discount_total" groups="sale.group_discount_per_so_line"/>
                                                <div> +
                                                    <field name="discount_total" widget="monetary" groups="base.group_advance_discount" class="oe_inline"/> =
                                                    <field name="discount_total" widget="monetary" class="oe_inline" groups="sale.group_discount_per_so_line"/>
                                                </div>
                                        </group>
                                    </group>
                                    <group col="20">
                                        <group name="second_row_left" colspan="8">
                                        </group>
                                        <group name="second_row_right" colspan="12">
                                        </group> 
                                    </group>
                                    <notebook colspan="4">
                                        <page string="Order Line">
                                            <group style="background-color: #eeeeee;">
                                                <group>
                                                    <field name="tax_id" widget="many2many_tags" domain="['&amp;',('parent_id','=',False),('type_tax_use','&lt;&gt;','purchase')]"/>
                                                </group>
                                                 <group class="oe_subtotal_footer oe_right">
                                                    <separator class="oe_horizontal_separator" style="margin:0px 0px 10px 0px; font-size:14px;" colspan="12" string="In Document Currency"/>
                                                    <field name="base_price" readonly="1" widget="monetary"/>
                                                    <field name="amount" attrs="{'readonly':[('parent.entry_type','!=','amount')],'required':[('parent.entry_type','!=','amount')]}" widget="monetary"/>
                                                    <field name="amount_tax" readonly="1" widget="monetary"/>
                                                    <field name="amount_total" widget="monetary" attrs="{'readonly':[('parent.entry_type','!=','amount_total')]}"/>
                                                </group>
                                            </group>
                                        </page>
                                        <page string="Calculation">
                                           <group>
                                                <group>
                                                </group>
                                                <group class="oe_subtotal_footer oe_right" style="background-color: #eeeeee;">
                                                    <separator class="oe_horizontal_separator" style="margin:0px 0px 10px 0px; font-size:14px;" colspan="8" string="In Company Currency"/>
                                                    <field name="lcy_base_price" readonly="1" widget="monetary"/> 
                                                    <field name="lcy_amount" readonly="1" widget="monetary"/>
                                                    <field name="lcy_amount_tax" readonly="1" widget="monetary"/>
                                                    <field name="lcy_amount_total" readonly="1" widget="monetary"/>
                                                </group>
                                             </group> 
                                        </page>
                                        <page string="Advanced">
                                            <group>
                                                <group>
                                                    <field name="supplier_cost"/>
                                                    <field name="landed_costs"/>
                                                    <field name="total_costs"/>
                                                    <field name="overhead_cost"/>
                                                </group>
                                                <group>
                                                    <field name="margin_brutto1"/>
                                                    <field name="margin_brutto1_percent"/>
                                                    <field name="margin_brutto2"/>
                                                    <field name="margin_brutto2_percent"/>
                                                </group>
                                            </group>
                                        </page>
                                        <page string="Notes">
                                            <group>
                                                <field name="notes" nolabel="1"/>
                                            </group>
                                        </page>
                                        <page string="History" groups="base.group_no_one">
                                            <div groups="base.group_no_one">
                                                <label for="invoice_lines"/>
                                                <field name="invoice_lines"/>
                                            </div>
                                        </page>
                                        
                                        <page string="Invoice Lines" groups="base.group_compatibility_deprec"> <!--group deperc for now to prevent from cluttering view -->
                                            <field name="sale_order_line_invoice_line_ids" colspan="4" nolabel="1" context="{'tree_view_ref':'sale_base.view_sale_order_line_invoice_line_tree'}"/>
                                        </page>
                                        <page string="Extra Info">
                                            <group>
                                                <field name="th_weight"/>
                                                <field name="address_allotment_id"/>
                                            </group>
                                        </page>
                                        <page string="Deprec" groups="base.group_compatibility_deprec">
                                            <group>
                                                <label for="product_uom_qty"/>
                                                <div>
                                                    <field context="{'partner_id':parent.partner_id, 'quantity':product_uom_qty, 'pricelist':parent.pricelist_id, 'uom':product_uom}" name="product_uom_qty" class="oe_inline"/>
                                                    <field name="product_uom" groups="product.group_uom" class="oe_inline oe_no_button"/>
                                                </div>
                                                <label for="product_uos_qty" groups="product.group_uos"/>
                                                <div groups="product.group_uos">
                                                    <field name="product_uos_qty" class="oe_inline"/>
                                                    <field name="product_uos" options="{&quot;no_open&quot;: True}" class="oe_inline"/>
                                                    <field name="uom_domain" invisible="1"/>
                                                </div>
                                            </group>
                                            <group>
                                                <field name="lcy_price_subtotal"/>
                                                <field name="sequence"/>
                                            </group>
                                        </page>
                                    </notebook>
                                </form>
                                <tree string="Sales Order Lines"><!--editable="bottom"-->
                                    <field name="sequence" widget="handle"/>
                                    <field name="state" invisible="1"/>
                                    <field name="th_weight" invisible="1"/>
                                    <field name="product_id" context="{'partner_id':parent.partner_id, 'quantity':quantity, 'pricelist':parent.pricelist_id, 'uom':product_uom}" groups="base.group_user"/>
                                    <field name="name"/>
                                    <field name="quantity" context="{'partner_id':parent.partner_id, 'quantity':quantity, 'pricelist':parent.pricelist_id, 'uom':product_uom}"/>
                                    <field name="product_uom" groups="product.group_uom" options="{&quot;no_open&quot;: True}"/>
                                    <field name="product_uos_qty" groups="product.group_uos" invisible="1"/>
                                    <field name="product_uos" string="UoS" groups="product.group_uos" invisible="1"/>
                                    <field name="price_unit"/>
                                    <field name="tax_id" widget="many2many_tags" domain="[('parent_id','=',False),('type_tax_use','&lt;&gt;','purchase')]"/>
                                    <field name="discount" groups="sale.group_discount_per_so_line"/>
                                    <field name="price_subtotal"/>
                                </tree>
                            </field>
                            <group col="10" style="background-color: #eeeeee;">
                                <group colspan="8">
                                    <field name="tax_line" nolabel="1" class="oe_inline">
                                        <tree string="Taxes">
                                            <field name="name"/>
                                            <field name="account_id" groups="account.group_account_invoice"/>
                                            <field name="base" readonly="1"/>
                                            <field name="amount"/>
                                            <field name="base_amount" invisible="1"/>
                                            <field name="tax_amount" invisible="1"/>
                                            <field name="factor_base" invisible="1"/>
                                            <field name="factor_tax" invisible="1"/>
                                        </tree>
                                    </field>
                                </group>
                                <group class="oe_subtotal_footer oe_right">
                                    <separator string="In Company Currency" class="oe_horizontal_separator" style="margin:0px 0px 10px 0px; font-size:14px;" colspan="2"/>
                                    <field name="lcy_amount_untaxed" widget="monetary" options="{'currency_field': 'lcy_currency_id'}"/>
                                    <field name="lcy_amount_tax" widget="monetary" options="{'currency_field': 'lcy_currency_id'}"/>
                                    <field name="lcy_amount_total" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'lcy_currency_id'}"/>
                                </group>
                                <group class="oe_subtotal_footer oe_right" name="sale_total">
                                    <separator string="In Sale Order Currency" class="oe_horizontal_separator" style="margin:0px 0px 10px 0px; font-size:14px;" colspan="2"/>
                                    <field name="global_discount_percent" widget="monetary"/>
                                    <field name="additional_discount_amount" widget="monetary"/>
                                    <field name="amount_untaxed" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <field name="amount_tax" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                    <div class="oe_subtotal_footer_separator oe_inline">
                                        <label for="amount_total"/>
                                        <button name="button_dummy" states="draft,sent" string="(update)" type="object" class="oe_edit_only oe_link"/>
                                    </div>
                                    <field name="amount_total" nolabel="1" class="oe_subtotal_footer_separator" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                </group>
                            </group>
                            <group colspan="4" col="10">
                                
                                <group colspan="3">
                                    
                                </group>
                            </group>
                        </page>
                        <page string="Other Information" groups="base.group_user">
                            <group>
                                <group name="sales_person" groups="base.group_user">
                                    <field name="user_id" context="{'default_groups_ref': ['base.group_user', 'base.group_partner_manager', 'account.group_account_invoice', 'base.group_sale_salesman_all_leads']}"/>
                                    <field name="section_id" options="{'no_create': True}" groups="base.group_multi_salesteams"/>
                                    <field groups="base.group_no_one" name="origin"/>
                                </group>
                                <group name="sale_pay">
                                    <field name="company_id" widget="selection" groups="base.group_multi_company"/>
                                </group>
                                <group>
                                    <field name="invoiced"/>
                                    <field name="invoice_exists" invisible="1"/>
                                </group>
                            </group>
                            <group colspan="4">
                                <field name="note" nolabel="1" colspan="4" class="oe_inline" placeholder="Terms and conditions..."/>
                            </group>
                        </page>
                        <page string="Advanced">
                            <group>
                                <group>                         
                                    <field name="journal_id"/>
                                    <field name="partner_bank_id"/>
                                    <field name="list_amount"/>
                                    <field name="supplier_cost"/>
                                    <field name="landed_cost"/>
                                    <field name="total_cost"/>
                                </group>
                                <group> 
                                    <label for="force_rate"/>
                                    <div>
                                        <field name="force_rate" class="oe_inline"/>
                                        <field name="lcy_rate" attrs="{'readonly':[('force_rate','!=',True)],'required':[('force_rate','=',True)]}" class="oe_inline"/>
                                        <field name="lcy_date" attrs="{'readonly':[('force_rate','!=',True)],'required':[('force_rate','=',True)]}" class="oe_inline"/>
                                    </div>
                                    <!--field name="lcy_amount_untaxed"/--> 
                                    <!--field name="lcy_amount_tax"/-->
                                    <!--field name="lcy_amount_total"/-->
                                </group>
                            </group>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
                </form>
            